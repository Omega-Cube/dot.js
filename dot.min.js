var DotUtils=function(){};DotUtils.escapeContainer=null;DotUtils.escapeText=null;DotUtils.escapeHtml=function(){DotUtils.escapeContainer=document.createElement("div");DotUtils.escapeText=document.createTextNode("");DotUtils.escapeContainer.appendChild(DotUtils.escapeText);return realEscape=function(a){DotUtils.escapeText.data=a;return DotUtils.escapeContainer.innerHTML}}();DotUtils.setHtml=function(a,c){c=c.replace(/<script[^>]*>([\\S\\s]*?)<\/script>/img,"");a.innerHTML=c};
DotUtils.bind=function(a,c){return function(){return c.apply(a,Array.prototype.slice.call(arguments))}};
DotUtils.ajaxGet=function(a,c,b){var d=null;if(window.XMLHttpRequest)d=new window.XMLHttpRequest;else try{d=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){d=null}d===null&&alert("Your browser does not support basic AJAX requests");if(typeof c!=="undefined"&&c!==null){var g=false;a.indexOf("?")>-1&&(idFirst=false);for(p in c)g?(a+="?",g=false):a+="&",a+=escape(p)+"="+escape(c[p])}d.open("GET",a,true);d.onreadystatechange=function(){d.readyState==4&&(d.status==200?b(d.responseText):d.status==0&&(alert("It seems you have some cross-domain access issues. Dot.js does not support cross-domain loading (yet ?). I'll still try to load your data but the app might get unstable."),
b(d.responseText)))};d.send()};DotUtils.extend=function(a,c){for(var b in c)a[b]=c[b];return a};
DotUtils.createClass=function(){function a(){this.initialize.apply(this,arguments)}var c=null,b=Array.prototype.slice.call(arguments);typeof b[0]==="function"&&(c=b.shift());if(a.superclass=c){var d=function(){};d.prototype=c.prototype;a.prototype=new d}for(c=0;c<b.length;c++)DotUtils.addMethods(a,b[c]);if(!a.prototype.initialize)a.prototype.initialize=DotUtils.emptyFunction;return a.prototype.constructor=a};DotUtils.emptyFunction=function(){};
DotUtils.addMethods=function(a,c){var b=a.superclass&&a.superclass.prototype,d=[],e;for(e in c)d.push(e);for(var g=0,h=d.length;g<h;g++){e=d[g];var f=c[e];if(b&&typeof f==="function"&&DotUtils.argumentNames(f)[0]=="$super")var i=f,f=function(a){return function(){return b[a].apply(this,arguments)}}(e),f=DotUtils.wrap(f,i);a.prototype[e]=f}return a};
DotUtils.argumentNames=function(a){a=a.toString().match(/^[\s\(]*function[^(]*\(([^\)]*)\)/)[1].replace(/\s+/g,"").split(",");return a.length==1&&!a[0]?[]:a};DotUtils.wrap=function(a,c){return function(){return c.apply(this,[DotUtils.bind(this,a)].concat(Array.prototype.slice.call(arguments)))}};
var DotTokenizer=DotUtils.createClass({initialize:function(a){this.str=a},takeChars:function(a){a||(a=1);for(var c=[];a--;){var b=this.str.match(/^(\S+)\s*/);b?(this.str=this.str.substr(b[0].length),c.push(b[1])):c.push(false)}return 1==c.length?c[0]:c},takeNumber:function(a){a||(a=1);if(1==a)return Number(this.takeChars());else{for(var c=this.takeChars(a);a--;)c[a]=Number(c[a]);return c}},takeString:function(){var a=Number(this.takeChars()),c=0,b;if("-"!=this.str.charAt(0))return false;for(;0<a;)++c,
b=this.str.charCodeAt(c),128>b?--a:a-=2048>b?2:3;a=this.str.substr(1,c);this.str=this.str.substr(1+c).replace(/^\s+/,"");return a}}),DotEntity=DotUtils.createClass({initialize:function(a,c,b,d,e,g){this.defaultAttrHashName=a;this.name=c;this.dot=b;this.rootGraph=d;this.parentGraph=e;this.immediateGraph=g;this.attrs={};this.drawAttrs={}},initBB:function(){var a=this.getAttr("pos").match(/([0-9.]+),([0-9.]+)/),c=Math.round(a[1]),a=Math.round(this.dot.height-a[2]);this.bbRect=new Rect(c,a,c,a)},getAttr:function(a,
c){typeof escStrinng==="undefined"&&(c=false);var b=this.attrs[a];if(typeof b==="undefined")for(var d=this.parentGraph;typeof d!=="undefined";)if(b=d[this.defaultAttrHashName][a],typeof b==="undefined")d=d.parentGraph;else break;b&&c&&(b=b.replace(this.escStringMatchRe,function(a,c){switch(c){case "N":case "E":return this.name;case "T":return this.tailNode;case "H":return this.headNode;case "G":return this.immediateGraph.name;case "L":return this.getAttr("label",true)}return a}.bind(this)));return b},
draw:function(a,c,b){var d,e,g;if(!b){this.initBB();var h=document.createElement("div");this.dot.elements.appendChild(h)}for(daKey in this.drawAttrs){var f=new DotTokenizer(this.drawAttrs[daKey]);if(d=f.takeChars()){var i="solid";for(a.save();d;){switch(d){case "E":case "e":var l="E"==d,k=f.takeNumber();d=this.dot.height-f.takeNumber();e=f.takeNumber();var m=f.takeNumber(),k=new Ellipse(k,d,e,m);break;case "P":case "p":case "L":var l="P"==d,m="L"!=d,j=f.takeNumber();e=f.takeNumber(2*j);k=new Path;
for(d=2;d<2*j;d+=2)k.addBezier([new Point(e[d-2],this.dot.height-e[d-1]),new Point(e[d],this.dot.height-e[d+1])]);m&&k.addBezier([new Point(e[2*j-2],this.dot.height-e[2*j-1]),new Point(e[0],this.dot.height-e[1])]);break;case "B":case "b":l="b"==d;j=f.takeNumber();e=f.takeNumber(2*j);k=new Path;for(d=2;d<2*j;d+=6)k.addBezier([new Point(e[d-2],this.dot.height-e[d-1]),new Point(e[d],this.dot.height-e[d+1]),new Point(e[d+2],this.dot.height-e[d+3]),new Point(e[d+4],this.dot.height-e[d+5])]);break;case "I":d=
f.takeNumber();e=this.dot.height-f.takeNumber();var m=f.takeNumber(),j=f.takeNumber(),o=f.takeString();this.dot.images[o]||(this.dot.images[o]=new DotImage(this.dot,o));this.dot.images[o].draw(a,d,e-j,m,j);break;case "T":d=Math.round(c*f.takeNumber()+this.dot.padding);e=Math.round(c*this.dot.height+2*this.dot.padding-(c*(f.takeNumber()+this.dot.bbScale*fontSize)+this.dot.padding));m=f.takeNumber();j=Math.round(c*f.takeNumber());o=f.takeString();if(!b&&!/^\s*$/.test(o)){o=DotUtils.escapeHtml(o);do if(matches=
o.match(/ ( +)/)){var q=" ";matches[1].length.times(function(){q+="&nbsp;"});o=o.replace(/  +/,q)}while(matches);var n,r=this.getAttr("URL",true)||this.getAttr("href",true);if(r){var s=this.getAttr("target",true)||"_self",u=this.getAttr("tooltip",true)||this.getAttr("label",true);n=document.createElement("a");n.href=r;n.target=s;n.title=u;var r="onclick,onmousedown,onmouseup,onmouseover,onmousemove,onmouseout".split(","),t;for(t in r)(s=this.getAttr(t,true))&&n.setAttribute(t,s);n.style.textDecoration=
"none"}else n=document.createElement("span");DotUtils.setHtml(n,o);n.style.fontSize=Math.round(fontSize*c*this.dot.bbScale)+"px";n.style.fontFamily=fontFamily;n.style.color=g.textColor;n.style.position="absolute";n.style.textAlign=-1==m?"left":1==m?"right":"center";n.style.left=d-(1+m)*j+"px";n.style.top=e+"px";n.style.width=2*j+"px";if(1!=g.opacity)n.style.opacity=g.opacity;this.dot.elements.appendChild(n)}break;case "C":case "c":d="C"==d;e=this.parseColor(f.takeString());d?a.fillStyle=e.canvasColor:
(g=e,a.strokeStyle=e.canvasColor);break;case "F":fontSize=f.takeNumber();fontFamily=f.takeString();switch(fontFamily){case "Times-Roman":fontFamily="Times New Roman";break;case "Courier":fontFamily="Courier New";break;case "Helvetica":fontFamily="Arial"}break;case "S":d=f.takeString();switch(d){case "solid":case "filled":break;case "dashed":case "dotted":i=d;break;case "bold":a.lineWidth=2;break;default:(matches=d.match(/^setlinewidth\((.*)\)$/))?a.lineWidth=Number(matches[1]):debug("unknown style "+
d)}break;default:debug("unknown token "+d);return}k&&(this.dot.drawPath(a,k,l,i),b||this.bbRect.expandToInclude(k.getBB()),k=void 0);d=f.takeChars()}if(!b)h.style.position="absolute",h.style.left=Math.round(c*this.bbRect.l+this.dot.padding)+"px",h.style.top=Math.round(c*this.bbRect.t+this.dot.padding)+"px",h.style.width=Math.round(c*this.bbRect.getWidth())+"px",h.style.height=Math.round(c*this.bbRect.getHeight())+"px";a.restore()}}},parseColor:function(a){var c={opacity:1};if(/^#(?:[0-9a-f]{2}\s*){3,4}$/i.test(a))return this.dot.parseHexColor(a);
var b=a.match(/^(\d+(?:\.\d+)?)[\s,]+(\d+(?:\.\d+)?)[\s,]+(\d+(?:\.\d+)?)$/);if(b)return c.canvasColor=c.textColor=this.dot.hsvToRgbColor(b[1],b[2],b[3]),c;var d=this.getAttr("colorscheme")||"X11",e=a;if(b=a.match(/^\/(.*)\/(.*)$/))b[1]&&(d=b[1]),e=b[2];else if(b=a.match(/^\/(.*)$/))d="X11",e=b[1];e=e.toLowerCase();b=d.toLowerCase();if(b=Dot.prototype.colors[b]){var g=b[e];if(g)return this.dot.parseHexColor("#"+g)}if(g=Dot.prototype.colors.fallback[e])return this.dot.parseHexColor("#"+g);b||debug("unknown color scheme "+
d);debug("unknown color "+a+"; color scheme is "+d);c.canvasColor=c.textColor="#000000";return c}}),DotNode=DotUtils.createClass(DotEntity,{initialize:function($super,c,b,d,e){$super("nodeAttrs",c,b,d,e,e)}});DotUtils.extend(DotNode.prototype,{escStringMatchRe:/\\([NGL])/g});var DotEdge=DotUtils.createClass(DotEntity,{initialize:function($super,c,b,d,e,g,h){$super("edgeAttrs",c,b,d,e,e);this.tailNode=g;this.headNode=h}});DotUtils.extend(DotEdge.prototype,{escStringMatchRe:/\\([EGTHL])/g});
var DotGraph=DotUtils.createClass(DotEntity,{initialize:function($super,c,b,d,e){$super("attrs",c,b,d,e,this);this.nodeAttrs={};this.edgeAttrs={};this.nodes=[];this.edges=[];this.subgraphs=[]},initBB:function(){var a=this.getAttr("bb").split(",");this.bbRect=new Rect(a[0],this.dot.height-a[1],a[2],this.dot.height-a[3])},draw:function($super,c,b,d){$super(c,b,d);for(var e=[this.subgraphs,this.nodes,this.edges],g=0,h=e.length;g<h;++g)for(var f=e[g],i=0,l=f.length;i<l;++i)f[i].draw(c,b,d)}});
DotUtils.extend(DotGraph.prototype,{escStringMatchRe:/\\([GL])/g});
var Dot=DotUtils.createClass({maxXdotVersion:"1.2",colors:{fallback:{black:"000000",lightgrey:"d3d3d3",white:"ffffff"}},initialize:function(a,c,b){this.canvas=document.createElement("canvas");this.canvas.style.position="absolute";if(!Dot.canvasCounter)Dot.canvasCounter=0;this.canvas.id="dot_canvas_"+ ++Dot.canvasCounter;this.elements=document.createElement("div");this.elements.style.position="absolute";this.container=document.getElementById(a);this.container.style.position="relative";this.container.appendChild(this.canvas);
if(typeof G_vmlCanvasManager!=="undefined")G_vmlCanvasManager.initElement(this.canvas),this.canvas=document.getElementById(this.canvas.id);this.container.appendChild(this.elements);this.ctx=this.canvas.getContext("2d");this.scale=1;this.padding=8;this.dashLength=6;this.dotSpacing=4;this.graphs=[];this.images={};this.numImagesFinished=this.numImages=0;c&&this.load(c,b)},setScale:function(a){this.scale=a},getScale:function(){return this.scale},setImagePath:function(a){this.imagePath=a},load:function(a,
c){document.getElementById("debug_output").innerHTML="";var b=DotUtils.bind(this,function(a){this.parse(a)});DotUtils.ajaxGet(a,c,b)},parse:function(a){this.graphs=[];this.height=this.width=0;this.bbEnlarge=this.maxHeight=this.maxWidth=false;this.bbScale=1;this.dpi=96;this.bgcolor={opacity:1};this.bgcolor.canvasColor=this.bgcolor.textColor="#ffffff";for(var a=a.split(/\r?\n/),c=0,b,d,e,g,h,f,i,l,k,m,j=[];c<a.length;)if(b=a[c++].replace(/^\s+/,""),""!=b&&"#"!=b.substr(0,1)){for(;c<a.length&&";"!=(d=
b.substr(b.length-1,b.length))&&"{"!=d&&"}"!=d;)"\\"==d&&(b=b.substr(0,b.length-1)),b+=a[c++];if(0==j.length){if(e=b.match(this.graphMatchRe))g=new DotGraph(e[3],this),j.unshift(g),j[0].strict=typeof e[1]!=="undefined",j[0].type="graph"==e[2]?"undirected":"directed",j[0].attrs.xdotversion="1.0",this.graphs.push(j[0])}else if(e=b.match(this.subgraphMatchRe))j.unshift(new DotGraph(e[1],this,g,j[0])),j[1].subgraphs.push(j[0]);if(!e)if("}"==b){if(j.shift(),0==j.length)break}else{if(e=b.match(this.nodeMatchRe))switch(f=
e[2],i=e[5],m=j[0].drawAttrs,h=false,f){case "graph":k=j[0].attrs;h=true;break;case "node":k=j[0].nodeAttrs;break;case "edge":k=j[0].edgeAttrs;break;default:b=new DotNode(f,this,g,j[0]),k=b.attrs,m=b.drawAttrs,j[0].nodes.push(b)}else if(e=b.match(this.edgeMatchRe))f=e[1],i=e[8],b=new DotEdge(f,this,g,j[0],e[2],e[5]),k=b.attrs,m=b.drawAttrs,j[0].edges.push(b);if(e){do{if(0==i.length)break;if(e=i.match(this.attrMatchRe)){if(i=i.substr(e[0].length),b=e[1],l=this.unescape(e[2]),/^_.*draw_$/.test(b)?m[b]=
l:k[b]=l,h&&1==j.length)switch(b){case "bb":b=l.split(/,/);this.width=Number(b[2]);this.height=Number(b[3]);break;case "bgcolor":this.bgcolor=g.parseColor(l);break;case "dpi":this.dpi=l;break;case "size":(b=l.match(/^(\d+|\d*(?:\.\d+)),\s*(\d+|\d*(?:\.\d+))(!?)$/))?(this.maxWidth=72*Number(b[1]),this.maxHeight=72*Number(b[2]),this.bbEnlarge="!"==b[3]):debug("can't parse size");break;case "xdotversion":0>this.versionCompare(this.maxXdotVersion,k.xdotversion)&&debug("unsupported xdotversion "+k.xdotversion+
"; this script currently supports up to xdotversion "+this.maxXdotVersion)}}else debug("can't read attributes for entity "+f+" from "+i)}while(e)}}}this.draw()},draw:function(a){typeof a==="undefined"&&(a=false);var c=this.scale*this.dpi/72,b=Math.round(c*this.width+2*this.padding),d=Math.round(c*this.height+2*this.padding);if(!a){this.canvas.width=b;this.canvas.height=d;this.canvas.style.width=b+"px";this.canvas.style.height=d+"px";for(this.container.style.width=b+"px";this.elements.firstChild;)this.elements.removeChild(this.elements.firstChild)}this.ctx.save();
this.ctx.lineCap="round";this.ctx.fillStyle=this.bgcolor.canvasColor;this.ctx.fillRect(0,0,b,d);this.ctx.translate(this.padding,this.padding);this.ctx.scale(c,c);this.graphs[0].draw(this.ctx,c,a);this.ctx.restore()},drawPath:function(a,c,b,d){b&&(a.beginPath(),c.makePath(a),a.fill());if(a.fillStyle!=a.strokeStyle||!b){switch(d){case "dashed":a.beginPath();c.makeDashedPath(a,this.dashLength);break;case "dotted":var e=a.lineWidth;a.lineWidth*=2;a.beginPath();c.makeDottedPath(a,this.dotSpacing);break;
default:b||(a.beginPath(),c.makePath(a))}a.stroke();if(e)a.lineWidth=e}},unescape:function(a){var c=a.match(/^"(.*)"$/);return c?c[1].replace(/\\"/g,'"'):a},parseHexColor:function(a){if(a=a.match(/^#([0-9a-f]{2})\s*([0-9a-f]{2})\s*([0-9a-f]{2})\s*([0-9a-f]{2})?$/i)){var c,b="#"+a[1]+a[2]+a[3],d=1;a[4]?(d=parseInt(a[4],16)/255,c="rgba("+parseInt(a[1],16)+","+parseInt(a[2],16)+","+parseInt(a[3],16)+","+d+")"):c=b}return{canvasColor:c,textColor:b,opacity:d}},hsvToRgbColor:function(a,c,b){var d,e,g,h,
f,i;a*=360;d=Math.floor(a/60)%6;e=a/60-d;a=b*(1-c);g=b*(1-e*c);c=b*(1-(1-e)*c);switch(d){case 0:h=b;f=c;i=a;break;case 1:h=g;f=b;i=a;break;case 2:h=a;f=b;i=c;break;case 3:h=a;f=g;i=b;break;case 4:h=c;f=a;i=b;break;case 5:h=b,f=a,i=g}return"rgb("+Math.round(255*h)+","+Math.round(255*f)+","+Math.round(255*i)+")"},versionCompare:function(a,c){for(var a=a.split("."),c=c.split("."),b,d;a.length||c.length;){b=a.length?a.shift():0;d=c.length?c.shift():0;if(b<d)return-1;if(b>d)return 1}return 0},idMatch:'([a-zA-Z\u0080-\uffff_][0-9a-zA-Z\u0080-\uffff_]*|-?(?:\\.\\d+|\\d+(?:\\.\\d*)?)|"(?:\\\\"|[^"])*"|<(?:<[^>]*>|[^<>]+?)+>)'});
Dot.prototype.nodeIdMatch=Dot.prototype.idMatch+"(?::"+Dot.prototype.idMatch+")?(?::"+Dot.prototype.idMatch+")?";Dot.prototype.graphMatchRe=RegExp("^(strict\\s+)?(graph|digraph)(?:\\s+"+Dot.prototype.idMatch+")?\\s*{$","i");Dot.prototype.subgraphMatchRe=RegExp("^(?:subgraph\\s+)?"+Dot.prototype.idMatch+"?\\s*{$","i");Dot.prototype.nodeMatchRe=RegExp("^("+Dot.prototype.nodeIdMatch+")\\s+\\[(.+)\\];$");
Dot.prototype.edgeMatchRe=RegExp("^("+Dot.prototype.nodeIdMatch+"\\s*-[->]\\s*"+Dot.prototype.nodeIdMatch+")\\s+\\[(.+)\\];$");Dot.prototype.attrMatchRe=RegExp("^"+Dot.prototype.idMatch+"="+Dot.prototype.idMatch+"(?:[,\\s]+|$)");
var DotImage=DotUtils.createClass({initialize:function(a,c){this.dot=a;++this.dot.numImages;this.finished=this.loaded=false;this.img=new Image;this.img.onload=this.onLoad.bind(this);this.img.onerror=this.onFinish.bind(this);this.img.onabort=this.onFinish.bind(this);this.img.src=this.dot.imagePath+c},onLoad:function(){this.loaded=true;this.onFinish()},onFinish:function(){this.finished=true;++this.dot.numImagesFinished;this.dot.numImages==this.dot.numImagesFinished&&this.dot.draw(true)},draw:function(a,
c,b,d,e){this.finished&&(this.loaded?a.drawImage(this.img,c,b,d,e):(debug("can't load image "+this.img.src),this.drawBrokenImage(a,c,b,d,e)))},drawBrokenImage:function(a,c,b,d,e){a.save();a.beginPath();(new Rect(c,b,c+d,b+d)).draw(a);a.moveTo(c,b);a.lineTo(c+d,b+d);a.moveTo(c+d,b);a.lineTo(c,b+e);a.strokeStyle="#f00";a.lineWidth=1;a.stroke();a.restore()}});
function debug(a,c){a=String(a);typeof c==="undefined"&&(c=true);c&&(a=a.escapeHTML());document.getElementById("debug_output").innerHTML+="&raquo;"+a+"&laquo;<br />"}
var Point=DotUtils.createClass({initialize:function(a,c){this.x=a;this.y=c},offset:function(a,c){this.x+=a;this.y+=c},distanceFrom:function(a){var c=this.x-a.x,a=this.y-a.y;return Math.sqrt(c*c+a*a)},makePath:function(a){a.moveTo(this.x,this.y);a.lineTo(this.x+0.001,this.y)}}),Bezier=DotUtils.createClass({initialize:function(a){this.points=a;this.order=a.length},pathCommands:[null,function(a,c){this.lineTo(a+0.001,c)},function(a,c){this.lineTo(a,c)},function(a,c,b,d){this.quadraticCurveTo(a,c,b,d)},
function(a,c,b,d,e,g){this.bezierCurveTo(a,c,b,d,e,g)}],reset:function(){with(Bezier.prototype)this.controlPolygonLength=controlPolygonLength,this.chordLength=chordLength,this.triangle=triangle,this.chordPoints=chordPoints,this.coefficients=coefficients},offset:function(a,c){for(var b=0,d=this.points.length;b<d;++b)this.points[b].offset(a,c);this.reset()},getBB:function(){var f;if(this.order){var a,c,b,d;c=this.points[0];a=b=c.x;f=d=c.y,c=f;var e=0;for(a=this.points.length;e<a;++e){var g=this.points[e];
a=Math.min(a,g.x);c=Math.min(c,g.y);b=Math.max(b,g.x);d=Math.max(d,g.y)}var h=new Rect(a,c,b,d);return(this.getBB=function(){return h})()}},isPointInBB:function(a,c,b){typeof b==="undefined"&&(b=0);var d=this.getBB();0<b&&(d=DotUtils.extend({},d),d.inset(-b,-b));return!(a<d.l||a>d.r||c<d.t||c>d.b)},isPointOnBezier:function(a,c,b){typeof b==="undefined"&&(b=0);if(!this.isPointInBB(a,c,b))return false;for(var d=this.chordPoints(),e=d[0].p,g,h,f,i,l,k,m=1;m<d.length;++m){g=d[m].p;h=e.x;f=e.y;i=g.x;l=
g.y;k=new Rect(h,f,i,l);if(k.isPointInBB(a,c,b)&&(h=Math.abs(h*l+i*c+a*f-i*f-a*l-h*c),e=e.distanceFrom(g),e=h/e,e<=b))return true;e=g}return false},controlPolygonLength:function(){for(var a=0,c=1;c<this.order;++c)a+=this.points[c-1].distanceFrom(this.points[c]);return(this.controlPolygonLength=function(){return a})()},chordLength:function(){var a=this.points[0].distanceFrom(this.points[this.order-1]);return(this.chordLength=function(){return a})()},triangle:function(){for(var a=this.points,c=[a],
b=1;b<this.order;++b){for(var d=[],e=0;e<this.order-b;++e){var g=a[e],h=a[e+1];d[e]=new Point((g.x+h.x)/2,(g.y+h.y)/2)}c.push(d);a=d}return(this.triangle=function(){return c})()},triangleAtT:function(a){for(var c=1-a,b=this.points,d=[b],e=1;e<this.order;++e){for(var g=[],h=0;h<this.order-e;++h){var f=b[h],i=b[h+1];g[h]=new Point(f.x*c+i.x*a,f.y*c+i.y*a)}d.push(g);b=g}return d},split:function(a){"undefined"==typeof a&&(a=0.5);for(var a=0.5==a?this.triangle():this.triangleAtT(a),c=Array(this.order),
b=Array(this.order),d=0;d<this.order;++d)c[d]=a[d][0],b[d]=a[this.order-1-d][d];return{left:new Bezier(c),right:new Bezier(b)}},mid:function(a,c){return this.split(c).left.split(a/c).right},chordPoints:function(){var a=[{tStart:0,tEnd:0,dt:0,p:this.points[0]}].concat(this._chordPoints(0,1));return(this.chordPoints=function(){return a})()},_chordPoints:function(a,c){var b=c-a;if(this.controlPolygonLength()<=1.001*this.chordLength())return[{tStart:a,tEnd:c,dt:b,p:this.points[this.order-1]}];else{var b=
a+b/2,d=this.split();return d.left._chordPoints(a,b).concat(d.right._chordPoints(b,c))}},markedEvery:function(a,c){for(var b=c||a,d=this.chordPoints(),e=[],g=0,h,f,i=1;i<d.length;++i)if(f=d[i],f.length=f.p.distanceFrom(d[i-1].p),0==f.length)g+=f.dt;else{h=b/f.length*f.dt;for(f.remainingLength=f.length;f.remainingLength>=b;)f.remainingLength-=b,g+=h,e.push(g),a!=b&&(b=a,h=b/f.length*f.dt);b-=f.remainingLength;g=f.tEnd}return{times:e,nextDistance:b}},coefficients:function(){function a(a){for(;a.length>
1;){for(var c=Array(a.length-1),b=0;b<a.length-1;++b){var d=c,e=b,g=a[b],j=a[b+1];g.push(0);var o=Array(g.length);o[0]=g[0];for(var q=0;q<j.length;++q)o[q+1]=g[q+1]+j[q]-g[q];d[e]=o}a=c}return a[0]}for(var c=[],b=[],d=0,e;e=this.points[d++];)c.push([e.x]),b.push([e.y]);var g={xs:a(c),ys:a(b)};return(this.coefficients=function(){return g})()},pointAtT:function(a){for(var c=this.coefficients(),b=c.xs,c=c.ys,d=b[b.length-1],e=c[c.length-1],g=b.length-1;--g>=0;)d=d*a+b[g],e=e*a+c[g];return new Point(d,
e)},makePath:function(a,c){"undefined"==typeof c&&(c=true);c&&a.moveTo(this.points[0].x,this.points[0].y);var b=this.pathCommands[this.order];if(b){for(var d=[],e=1==this.order?0:1;e<this.points.length;++e)d.push(this.points[e].x),d.push(this.points[e].y);b.apply(a,d)}},makeDashedPath:function(a,c,b,d){b||(b=c);"undefined"==typeof d&&(d=true);c=this.markedEvery(c,b);d&&c.times.unshift(0);(d=c.times.length%2)&&c.times.push(1);for(b=1;b<c.times.length;b+=2)this.mid(c.times[b-1],c.times[b]).makePath(a);
return{firstDistance:c.nextDistance,drawFirst:d}},makeDottedPath:function(a,c,b){b||(b=c);var d=this.markedEvery(c,b);c==b&&d.times.unshift(0);c=0;for(b=d.times.length;c<b;++c)this.pointAtT(d.times[c]).makePath(a);return d.nextDistance}}),Path=DotUtils.createClass({initialize:function(a){this.segments=a||[]},setupSegments:function(){},addBezier:function(a){this.segments.push(a instanceof Array?new Bezier(a):a)},offset:function(a,c){0==this.segments.length&&this.setupSegments();for(var b=0,d=this.segments.length;b<
d;++b)this.segments[b].offset(a,c)},getBB:function(){var j;0==this.segments.length&&this.setupSegments();var a,c,b,d;c=this.segments[0].points[0];a=b=c.x;j=d=c.y,c=j;for(var e=0,g=this.segments.length;e<g;++e)for(var h=this.segments[e].points,f=0,i=h.length;f<i;++f){var l=h[f];a=Math.min(a,l.x);c=Math.min(c,l.y);b=Math.max(b,l.x);d=Math.max(d,l.y)}var k=new Rect(a,c,b,d);return(this.getBB=function(){return k})()},isPointInBB:function(a,c,b){typeof b==="undefined"&&(b=0);var d=this.getBB();0<b&&(d=
DotUtils.extend({},d),d.inset(-b,-b));return!(a<d.l||a>d.r||c<d.t||c>d.b)},isPointOnPath:function(a,c,b){typeof b==="undefined"&&(b=0);if(!this.isPointInBB(a,c,b))return false;for(var d=0,e=this.segments.length;d<e;++d)if(this.segments[d].isPointOnBezier(a,c,b))throw $break;return false},isPointInPath:function(){return false},makePath:function(a){0==this.segments.length&&this.setupSegments();for(var c=true,b=0,d=this.segments.length;b<d;++b)this.segments[b].makePath(a,c),c=false},makeDashedPath:function(a,
c,b,d){0==this.segments.length&&this.setupSegments();for(var b={drawFirst:"undefined"==typeof d?true:d,firstDistance:b||c},d=0,e=this.segments.length;d<e;++d)b=this.segments[d].makeDashedPath(a,c,b.firstDistance,b.drawFirst)},makeDottedPath:function(a,c,b){0==this.segments.length&&this.setupSegments();b||(b=c);for(var d=0,e=this.segments.length;d<e;++d)b=this.segments[d].makeDottedPath(a,c,b)}}),Polygon=DotUtils.createClass(Path,{initialize:function($super,c){this.points=c||[];$super()},setupSegments:function(){for(var a=
0,c=this.points.length;a<c;++a){var b=a+1;c==b&&(b=0);this.addBezier([this.points[a],this.points[b]])}}}),Rect=DotUtils.createClass(Polygon,{initialize:function($super,c,b,d,e){this.l=c;this.t=b;this.r=d;this.b=e;$super()},inset:function(a,c){this.l+=a;this.t+=c;this.r-=a;this.b-=c;return this},expandToInclude:function(a){this.l=Math.min(this.l,a.l);this.t=Math.min(this.t,a.t);this.r=Math.max(this.r,a.r);this.b=Math.max(this.b,a.b)},getWidth:function(){return this.r-this.l},getHeight:function(){return this.b-
this.t},setupSegments:function($super){var c=this.getWidth(),b=this.getHeight();this.points=[new Point(this.l,this.t),new Point(this.l+c,this.t),new Point(this.l+c,this.t+b),new Point(this.l,this.t+b)];$super()}}),Ellipse=DotUtils.createClass(Path,{KAPPA:0.5522847498,initialize:function($super,c,b,d,e){this.cx=c;this.cy=b;this.rx=d;this.ry=e;$super()},setupSegments:function(){this.addBezier([new Point(this.cx,this.cy-this.ry),new Point(this.cx+this.KAPPA*this.rx,this.cy-this.ry),new Point(this.cx+
this.rx,this.cy-this.KAPPA*this.ry),new Point(this.cx+this.rx,this.cy)]);this.addBezier([new Point(this.cx+this.rx,this.cy),new Point(this.cx+this.rx,this.cy+this.KAPPA*this.ry),new Point(this.cx+this.KAPPA*this.rx,this.cy+this.ry),new Point(this.cx,this.cy+this.ry)]);this.addBezier([new Point(this.cx,this.cy+this.ry),new Point(this.cx-this.KAPPA*this.rx,this.cy+this.ry),new Point(this.cx-this.rx,this.cy+this.KAPPA*this.ry),new Point(this.cx-this.rx,this.cy)]);this.addBezier([new Point(this.cx-this.rx,
this.cy),new Point(this.cx-this.rx,this.cy-this.KAPPA*this.ry),new Point(this.cx-this.KAPPA*this.rx,this.cy-this.ry),new Point(this.cx,this.cy-this.ry)])}});

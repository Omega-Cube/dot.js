var DotUtils=function(){};DotUtils.escapeContainer=null;DotUtils.escapeText=null;DotUtils.escapeHtml=function(){DotUtils.escapeContainer=document.createElement("div");DotUtils.escapeText=document.createTextNode("");DotUtils.escapeContainer.appendChild(DotUtils.escapeText);return realEscape=function(a){DotUtils.escapeText.data=a;return DotUtils.escapeContainer.innerHTML}}();DotUtils.setHtml=function(a,b){b=b.replace(/<script[^>]*>([\\S\\s]*?)<\/script>/img,"");a.innerHTML=b};
DotUtils.bind=function(a,b){return function(){return b.apply(a,Array.prototype.slice.call(arguments))}};
DotUtils.ajaxGet=function(a,b,c){var d=null;if(window.XMLHttpRequest)d=new window.XMLHttpRequest;else try{d=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){d=null}d===null&&alert("Your browser does not support basic AJAX requests");if(typeof b!=="undefined"&&b!==null){var f=false;a.indexOf("?")>-1&&(idFirst=false);for(p in b)f?(a+="?",f=false):a+="&",a+=escape(p)+"="+escape(b[p])}d.open("GET",a,true);d.onreadystatechange=function(){d.readyState==4&&(d.status==200?c(d.responseText):d.status==0&&(alert("It seems you have some cross-domain access issues. Dot.js does not support cross-domain loading (yet ?). I'll still try to load your data but the app might get unstable."),
c(d.responseText)))};d.send()};DotUtils.extend=function(a,b){for(var c in b)a[c]=b[c];return a};DotUtils.addEventHandler=function(a,b,c){a.addEventListener?(b=="mousewheel"&&(b="DOMMouseScroll"),a.addEventListener(b,c,false)):a.attachEvent&&a.attachEvent("on"+b,c)};DotUtils.removeEventHandler=function(a,b,c){a.removeEventHandler?(b=="mousewheel"&&(b="DOMMouseScroll"),a.removeEventHandler(b,c,false)):a.detachEvent&&a.detachEvent("on"+b,c)};
DotUtils.preventDefault=function(a){a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();a.cancelBubble=true;a.cancel=true;a.returnValue=true;return false};
DotUtils.createClass=function(){function a(){this.initialize.apply(this,arguments)}var b=null,c=Array.prototype.slice.call(arguments);typeof c[0]==="function"&&(b=c.shift());if(a.superclass=b){var d=function(){};d.prototype=b.prototype;a.prototype=new d}for(b=0;b<c.length;b++)DotUtils.addMethods(a,c[b]);if(!a.prototype.initialize)a.prototype.initialize=DotUtils.emptyFunction;return a.prototype.constructor=a};DotUtils.emptyFunction=function(){};
DotUtils.addMethods=function(a,b){var c=a.superclass&&a.superclass.prototype,d=[],e;for(e in b)d.push(e);for(var f=0,i=d.length;f<i;f++){e=d[f];var h=b[e];if(c&&typeof h==="function"&&DotUtils.argumentNames(h)[0]=="$super")var g=h,h=function(a){return function(){return c[a].apply(this,arguments)}}(e),h=DotUtils.wrap(h,g);a.prototype[e]=h}return a};
DotUtils.argumentNames=function(a){a=a.toString().match(/^[\s\(]*function[^(]*\(([^\)]*)\)/)[1].replace(/\s+/g,"").split(",");return a.length==1&&!a[0]?[]:a};DotUtils.wrap=function(a,b){return function(){return b.apply(this,[DotUtils.bind(this,a)].concat(Array.prototype.slice.call(arguments)))}};var Dot=DotUtils.createClass({maxXdotVersion:"1.2",colors:{fallback:{black:"000000",lightgrey:"d3d3d3",white:"ffffff"}},initialize:function(a,b,c){this._canvas=document.createElement("canvas");this._canvas.style.position="absolute";if(!Dot._canvasCounter)Dot._canvasCounter=0;this._canvas.id="dot_canvas_"+ ++Dot._canvasCounter;this._elements=document.createElement("div");this._elements.style.position="absolute";this._container=document.getElementById(a);this._container.style.position="relative";this._container.appendChild(this._canvas);
if(typeof G_vmlCanvasManager!=="undefined")G_vmlCanvasManager.initElement(this._canvas),this._canvas=document.getElementById(this._canvas.id);this._container.appendChild(this._elements);this._ctx=this._canvas.getContext("2d");this._scale=1;this._minimumScale=0.5;this._maximumScale=2;this._padding=8;this._dashLength=6;this._dotSpacing=4;this._graphs=[];this._images={};this._numImagesFinished=this._numImages=0;this._imagePath="";this._graphLoaded=false;this._allowMouseScrolling=true;b&&this.load(b,
c);DotUtils.addEventHandler(this._container,"mousewheel",DotUtils.bind(this,this._handleMouseWheel))},setScale:function(a){this._scale=+a;if(this._scale<this._minimumScale)this._scale=this._minimumScale;if(this._scale>this._maximumScale)this._scale=this._maximumScale;this._graphLoaded&&this._draw()},getScale:function(){return this._scale},setMinimumScale:function(a){a=+a;if(a>this._maximumScale)a=this._maximumScale;a<=0&&(a=0.001);this._minimumScale=a;this._scale<a&&this.setScale(a)},getMinimumScale:function(){return this._minimumScale},
setMaximumScale:function(a){a=+a;if(a<this._minimumScale)a=this._minimumScale;this._maximumScale=a;this._scale>this._maximumScale&&this.setScale(this._maximumScale)},getMaximumScale:function(){return this._maximumScale},setAllowMouseScrolling:function(a){this._allowMouseScrolling=!!a},getAllowMouseScrolling:function(){return this._allowMouseScrolling},setImagePath:function(a){this._imagePath=a},getImagePath:function(){return this._imagePath},load:function(a,b){document.getElementById("debug_output").innerHTML=
"";var c=DotUtils.bind(this,function(a){this.parse(a)});DotUtils.ajaxGet(a,b,c)},parse:function(a){this._graphs=[];this._height=this._width=0;this._bbEnlarge=this._maxHeight=this._maxWidth=false;this._bbScale=1;this._dpi=96;this._bgcolor={opacity:1};this._bgcolor.canvasColor=this._bgcolor.textColor="#ffffff";for(var a=a.split(/\r?\n/),b=0,c,d,e,f,i,h,g,k,o,l,j=[];b<a.length;)if(c=a[b++].replace(/^\s+/,""),""!=c&&"#"!=c.substr(0,1)){for(;b<a.length&&";"!=(d=c.substr(c.length-1,c.length))&&"{"!=d&&
"}"!=d;)"\\"==d&&(c=c.substr(0,c.length-1)),c+=a[b++];if(0==j.length){if(e=c.match(this._graphMatchRe))f=new DotGraph(e[3],this),j.unshift(f),j[0]._strict=typeof e[1]!=="undefined",j[0]._type="graph"==e[2]?"undirected":"directed",j[0]._attrs.xdotversion="1.0",this._graphs.push(j[0])}else if(e=c.match(this._subgraphMatchRe))j.unshift(new DotGraph(e[1],this,f,j[0])),j[1]._subgraphs.push(j[0]);if(!e)if("}"==c){if(j.shift(),0==j.length)break}else{if(e=c.match(this._nodeMatchRe))switch(h=e[2],g=e[5],l=
j[0]._drawAttrs,i=false,h){case "graph":o=j[0]._attrs;i=true;break;case "node":o=j[0]._nodeAttrs;break;case "edge":o=j[0]._edgeAttrs;break;default:c=new DotNode(h,this,f,j[0]),o=c._attrs,l=c._drawAttrs,j[0]._nodes.push(c)}else if(e=c.match(this._edgeMatchRe))h=e[1],g=e[8],c=new DotEdge(h,this,f,j[0],e[2],e[5]),o=c._attrs,l=c._drawAttrs,j[0]._edges.push(c);if(e){do{if(0==g.length)break;if(e=g.match(this._attrMatchRe)){if(g=g.substr(e[0].length),c=e[1],k=this._unescape(e[2]),/^_.*draw_$/.test(c)?l[c]=
k:o[c]=k,i&&1==j.length)switch(c){case "bb":c=k.split(/,/);this._width=Number(c[2]);this._height=Number(c[3]);break;case "bgcolor":this._bgcolor=f.parseColor(k);break;case "dpi":this._dpi=k;break;case "size":(c=k.match(/^(\d+|\d*(?:\.\d+)),\s*(\d+|\d*(?:\.\d+))(!?)$/))?(this._maxWidth=72*Number(c[1]),this._maxHeight=72*Number(c[2]),this._bbEnlarge="!"==c[3]):debug("can't parse size");break;case "xdotversion":0>this._versionCompare(this.maxXdotVersion,o.xdotversion)&&debug("unsupported xdotversion "+
o.xdotversion+"; this script currently supports up to xdotversion "+this.maxXdotVersion)}}else debug("can't read attributes for entity "+h+" from "+g)}while(e)}}}this._draw();this._graphLoaded=true},_draw:function(a){typeof a==="undefined"&&(a=false);var b=this._scale*this._dpi/72,c=Math.round(b*this._width+2*this._padding),d=Math.round(b*this._height+2*this._padding);if(!a){this._canvas.width=c;this._canvas.height=d;this._canvas.style.width=c+"px";this._canvas.style.height=d+"px";for(this._container.style.width=
c+"px";this._elements.firstChild;)this._elements.removeChild(this._elements.firstChild)}this._ctx.save();this._ctx.lineCap="round";this._ctx.fillStyle=this._bgcolor.canvasColor;this._ctx.fillRect(0,0,c,d);this._ctx.translate(this._padding,this._padding);this._ctx.scale(b,b);this._graphs[0]._draw(this._ctx,b,a);this._ctx.restore()},_drawPath:function(a,b,c,d){c&&(a.beginPath(),b.makePath(a),a.fill());if(a.fillStyle!=a.strokeStyle||!c){switch(d){case "dashed":a.beginPath();b.makeDashedPath(a,this._dashLength);
break;case "dotted":var e=a.lineWidth;a.lineWidth*=2;a.beginPath();b.makeDottedPath(a,this._dotSpacing);break;default:c||(a.beginPath(),b.makePath(a))}a.stroke();if(e)a.lineWidth=e}},_unescape:function(a){var b=a.match(/^"(.*)"$/);return b?b[1].replace(/\\"/g,'"'):a},_parseHexColor:function(a){if(a=a.match(/^#([0-9a-f]{2})\s*([0-9a-f]{2})\s*([0-9a-f]{2})\s*([0-9a-f]{2})?$/i)){var b,c="#"+a[1]+a[2]+a[3],d=1;a[4]?(d=parseInt(a[4],16)/255,b="rgba("+parseInt(a[1],16)+","+parseInt(a[2],16)+","+parseInt(a[3],
16)+","+d+")"):b=c}return{canvasColor:b,textColor:c,opacity:d}},_hsvToRgbColor:function(a,b,c){var d,e,f,i,h,g;a*=360;d=Math.floor(a/60)%6;e=a/60-d;a=c*(1-b);f=c*(1-e*b);b=c*(1-(1-e)*b);switch(d){case 0:i=c;h=b;g=a;break;case 1:i=f;h=c;g=a;break;case 2:i=a;h=c;g=b;break;case 3:i=a;h=f;g=c;break;case 4:i=b;h=a;g=c;break;case 5:i=c,h=a,g=f}return"rgb("+Math.round(255*i)+","+Math.round(255*h)+","+Math.round(255*g)+")"},_versionCompare:function(a,b){for(var a=a.split("."),b=b.split("."),c,d;a.length||
b.length;){c=a.length?a.shift():0;d=b.length?b.shift():0;if(c<d)return-1;if(c>d)return 1}return 0},_handleMouseWheel:function(a){if(this._allowMouseScrolling){if(!a)a=window.event;var b=0;a.wheelDelta?(b=a.wheelDelta/120,window.opera&&(b=-b)):a.detail&&(b=-a.detail/3);b&&this.setScale(this.getScale()+b/10);return DotUtils.preventDefault(a)}},_idMatch:'([a-zA-Z\u0080-\uffff_][0-9a-zA-Z\u0080-\uffff_]*|-?(?:\\.\\d+|\\d+(?:\\.\\d*)?)|"(?:\\\\"|[^"])*"|<(?:<[^>]*>|[^<>]+?)+>)'});
Dot.prototype._nodeIdMatch=Dot.prototype._idMatch+"(?::"+Dot.prototype._idMatch+")?(?::"+Dot.prototype._idMatch+")?";Dot.prototype._graphMatchRe=RegExp("^(strict\\s+)?(graph|digraph)(?:\\s+"+Dot.prototype._idMatch+")?\\s*{$","i");Dot.prototype._subgraphMatchRe=RegExp("^(?:subgraph\\s+)?"+Dot.prototype._idMatch+"?\\s*{$","i");Dot.prototype._nodeMatchRe=RegExp("^("+Dot.prototype._nodeIdMatch+")\\s+\\[(.+)\\];$");
Dot.prototype._edgeMatchRe=RegExp("^("+Dot.prototype._nodeIdMatch+"\\s*-[->]\\s*"+Dot.prototype._nodeIdMatch+")\\s+\\[(.+)\\];$");Dot.prototype._attrMatchRe=RegExp("^"+Dot.prototype._idMatch+"="+Dot.prototype._idMatch+"(?:[,\\s]+|$)");var DotTokenizer=DotUtils.createClass({initialize:function(a){this._str=a},takeChars:function(a){a||(a=1);for(var b=[];a--;){var c=this._str.match(/^(\S+)\s*/);c?(this._str=this._str.substr(c[0].length),b.push(c[1])):b.push(false)}return 1==b.length?b[0]:b},takeNumber:function(a){a||(a=1);if(1==a)return Number(this.takeChars());else{for(var b=this.takeChars(a);a--;)b[a]=Number(b[a]);return b}},takeString:function(){var a=Number(this.takeChars()),b=0,c;if("-"!=this._str.charAt(0))return false;for(;0<
a;)++b,c=this._str.charCodeAt(b),128>c?--a:a-=2048>c?2:3;a=this._str.substr(1,b);this._str=this._str.substr(1+b).replace(/^\s+/,"");return a}});var DotEntity=DotUtils.createClass({initialize:function(a,b,c,d,e,f){this._defaultAttrHashName=a;this._name=b;this._dot=c;this._rootGraph=d;this._parentGraph=e;this._immediateGraph=f;this._attrs={};this._drawAttrs={}},_initBB:function(){var a=this.getAttr("pos").match(/([0-9.]+),([0-9.]+)/),b=Math.round(a[1]),a=Math.round(this._dot._height-a[2]);this._bbRect=new Rect(b,a,b,a)},getAttr:function(a,b){typeof escStrinng==="undefined"&&(b=false);var c=this._attrs[a];if(typeof c==="undefined")for(var d=
this._parentGraph;typeof d!=="undefined";)if(c=d[this._defaultAttrHashName][a],typeof c==="undefined")d=d._parentGraph;else break;c&&b&&(c=c.replace(this._escStringMatchRe,function(a,b){switch(b){case "N":case "E":return this._name;case "T":return this._tailNode;case "H":return this._headNode;case "G":return this._immediateGraph._name;case "L":return this.getAttr("label",true)}return a}.bind(this)));return c},_draw:function(a,b,c){var d,e,f,i=12;if(!c){this._initBB();var h=document.createElement("div");
this._dot._elements.appendChild(h)}for(daKey in this._drawAttrs){var g=new DotTokenizer(this._drawAttrs[daKey]);if(d=g.takeChars()){var k="solid";for(a.save();d;){switch(d){case "E":case "e":var o="E"==d,l=g.takeNumber();d=this._dot._height-g.takeNumber();e=g.takeNumber();var j=g.takeNumber(),l=new Ellipse(l,d,e,j);break;case "P":case "p":case "L":var o="P"==d,j="L"!=d,q=g.takeNumber();e=g.takeNumber(2*q);l=new Path;for(d=2;d<2*q;d+=2)l.addBezier([new Point(e[d-2],this._dot._height-e[d-1]),new Point(e[d],
this._dot._height-e[d+1])]);j&&l.addBezier([new Point(e[2*q-2],this._dot._height-e[2*q-1]),new Point(e[0],this._dot._height-e[1])]);break;case "B":case "b":o="b"==d;q=g.takeNumber();e=g.takeNumber(2*q);l=new Path;for(d=2;d<2*q;d+=6)l.addBezier([new Point(e[d-2],this._dot._height-e[d-1]),new Point(e[d],this._dot._height-e[d+1]),new Point(e[d+2],this._dot._height-e[d+3]),new Point(e[d+4],this._dot._height-e[d+5])]);break;case "I":d=g.takeNumber();e=this._dot._height-g.takeNumber();var j=g.takeNumber(),
q=g.takeNumber(),m=g.takeString();this._dot._images[m]||(this._dot._images[m]=new DotImage(this._dot,m));this._dot._images[m].draw(a,d,e-q,j,q);break;case "T":d=Math.round(b*g.takeNumber()+this._dot._padding);e=Math.round(b*this._dot._height+2*this._dot._padding-(b*(g.takeNumber()+this._dot._bbScale*i)+this._dot._padding));j=g.takeNumber();q=Math.round(b*g.takeNumber());m=g.takeString();if(!c&&!/^\s*$/.test(m)){m=DotUtils.escapeHtml(m);do if(matches=m.match(/ ( +)/)){var u=" ";matches[1].length.times(function(){u+=
"&nbsp;"});m=m.replace(/  +/,u)}while(matches);var n,r=this.getAttr("URL",true)||this.getAttr("href",true);if(r){var s=this.getAttr("target",true)||"_self",v=this.getAttr("tooltip",true)||this.getAttr("label",true);n=document.createElement("a");n.href=r;n.target=s;n.title=v;var r="onclick,onmousedown,onmouseup,onmouseover,onmousemove,onmouseout".split(","),t;for(t in r)(s=this.getAttr(t,true))&&n.setAttribute(t,s);n.style.textDecoration="none"}else n=document.createElement("span");DotUtils.setHtml(n,
m);n.style.fontSize=Math.round(i*b*this._dot._bbScale)+"px";n.style.fontFamily=fontFamily;n.style.color=f.textColor;n.style.position="absolute";n.style.textAlign=-1==j?"left":1==j?"right":"center";n.style.left=d-(1+j)*q+"px";n.style.top=e+"px";n.style.width=2*q+"px";if(1!=f.opacity)n.style.opacity=f.opacity;this._dot._elements.appendChild(n)}break;case "C":case "c":d="C"==d;e=this._parseColor(g.takeString());d?a.fillStyle=e.canvasColor:(f=e,a.strokeStyle=e.canvasColor);break;case "F":i=g.takeNumber();
fontFamily=g.takeString();switch(fontFamily){case "Times-Roman":fontFamily="Times New Roman";break;case "Courier":fontFamily="Courier New";break;case "Helvetica":fontFamily="Arial"}break;case "S":d=g.takeString();switch(d){case "solid":case "filled":break;case "dashed":case "dotted":k=d;break;case "bold":a.lineWidth=2;break;default:(matches=d.match(/^setlinewidth\((.*)\)$/))?a.lineWidth=Number(matches[1]):debug("unknown style "+d)}break;default:debug("unknown token "+d);return}l&&(this._dot._drawPath(a,
l,o,k),c||this._bbRect.expandToInclude(l.getBB()),l=void 0);d=g.takeChars()}if(!c)h.style.position="absolute",h.style.left=Math.round(b*this._bbRect.l+this._dot._padding)+"px",h.style.top=Math.round(b*this._bbRect.t+this._dot._padding)+"px",h.style.width=Math.round(b*this._bbRect.getWidth())+"px",h.style.height=Math.round(b*this._bbRect.getHeight())+"px";a.restore()}}},_parseColor:function(a){var b={opacity:1};if(/^#(?:[0-9a-f]{2}\s*){3,4}$/i.test(a))return this._dot._parseHexColor(a);var c=a.match(/^(\d+(?:\.\d+)?)[\s,]+(\d+(?:\.\d+)?)[\s,]+(\d+(?:\.\d+)?)$/);
if(c)return b.canvasColor=b.textColor=this._dot._hsvToRgbColor(c[1],c[2],c[3]),b;var d=this.getAttr("colorscheme")||"X11",e=a;if(c=a.match(/^\/(.*)\/(.*)$/))c[1]&&(d=c[1]),e=c[2];else if(c=a.match(/^\/(.*)$/))d="X11",e=c[1];e=e.toLowerCase();c=d.toLowerCase();if(c=Dot.prototype.colors[c]){var f=c[e];if(f)return this._dot._parseHexColor("#"+f)}if(f=Dot.prototype.colors.fallback[e])return this._dot._parseHexColor("#"+f);c||debug("unknown color scheme "+d);debug("unknown color "+a+"; color scheme is "+
d);b.canvasColor=b.textColor="#000000";return b}});var DotNode=DotUtils.createClass(DotEntity,{initialize:function($super,b,c,d,e){$super("_nodeAttrs",b,c,d,e,e)}});DotNode.prototype.escStringMatchRe=/\\([NGL])/g;var DotEdge=DotUtils.createClass(DotEntity,{initialize:function($super,b,c,d,e,f,i){$super("_edgeAttrs",b,c,d,e,e);this._tailNode=f;this._headNode=i}});DotEdge.prototype._escStringMatchRe=/\\([EGTHL])/g;var DotGraph=DotUtils.createClass(DotEntity,{initialize:function($super,b,c,d,e){$super("_attrs",b,c,d,e,this);this._nodeAttrs={};this._edgeAttrs={};this._nodes=[];this._edges=[];this._subgraphs=[]},_initBB:function(){var a=this.getAttr("bb").split(",");this._bbRect=new Rect(a[0],this._dot._height-a[1],a[2],this._dot._height-a[3])},_draw:function($super,b,c,d){$super(b,c,d);for(var e=[this._subgraphs,this._nodes,this._edges],f=0,i=e.length;f<i;++f)for(var h=e[f],g=0,k=h.length;g<k;++g)h[g]._draw(b,
c,d)}});DotGraph.prototype.escStringMatchRe=/\\([GL])/g;var DotImage=DotUtils.createClass({initialize:function(a,b){this._dot=a;++this._dot.numImages;this._finished=this._loaded=false;this._img=new Image;this._img.onload=this._onLoad.bind(this);this._img.onerror=this._onFinish.bind(this);this._img.onabort=this._onFinish.bind(this);this._img.src=this._dot.imagePath+b},_onLoad:function(){this._loaded=true;this.onFinish()},_onFinish:function(){this._finished=true;++this._dot._numImagesFinished;this._dot._numImages==this._dot._numImagesFinished&&this._dot._draw(true)},
_draw:function(a,b,c,d,e){this._finished&&(this._loaded?a.drawImage(this._img,b,c,d,e):(debug("can't load image "+this._img.src),this._drawBrokenImage(a,b,c,d,e)))},_drawBrokenImage:function(a,b,c,d,e){a.save();a.beginPath();(new Rect(b,c,b+d,c+d)).draw(a);a.moveTo(b,c);a.lineTo(b+d,c+d);a.moveTo(b+d,c);a.lineTo(b,c+e);a.strokeStyle="#f00";a.lineWidth=1;a.stroke();a.restore()}});var Point=DotUtils.createClass({initialize:function(a,b){this.x=a;this.y=b},offset:function(a,b){this.x+=a;this.y+=b},distanceFrom:function(a){var b=this.x-a.x,a=this.y-a.y;return Math.sqrt(b*b+a*a)},makePath:function(a){a.moveTo(this.x,this.y);a.lineTo(this.x+0.001,this.y)}});var Bezier=DotUtils.createClass({initialize:function(a){this.points=a;this.order=a.length},pathCommands:[null,function(a,b){this.lineTo(a+0.001,b)},function(a,b){this.lineTo(a,b)},function(a,b,c,d){this.quadraticCurveTo(a,b,c,d)},function(a,b,c,d,e,f){this.bezierCurveTo(a,b,c,d,e,f)}],reset:function(){with(Bezier.prototype)this.controlPolygonLength=controlPolygonLength,this.chordLength=chordLength,this.triangle=triangle,this.chordPoints=chordPoints,this.coefficients=coefficients},offset:function(a,
b){for(var c=0,d=this.points.length;c<d;++c)this.points[c].offset(a,b);this.reset()},getBB:function(){var g;if(this.order){var a,b,c,d;b=this.points[0];a=c=b.x;g=d=b.y,b=g;var e=0;for(a=this.points.length;e<a;++e){var f=this.points[e];a=Math.min(a,f.x);b=Math.min(b,f.y);c=Math.max(c,f.x);d=Math.max(d,f.y)}var i=new Rect(a,b,c,d);return(this.getBB=function(){return i})()}},isPointInBB:function(a,b,c){typeof c==="undefined"&&(c=0);var d=this.getBB();0<c&&(d=DotUtils.extend({},d),d.inset(-c,-c));return!(a<
d.l||a>d.r||b<d.t||b>d.b)},isPointOnBezier:function(a,b,c){typeof c==="undefined"&&(c=0);if(!this.isPointInBB(a,b,c))return false;for(var d=this.chordPoints(),e=d[0].p,f,i,h,g,k,o,l=1;l<d.length;++l){f=d[l].p;i=e.x;h=e.y;g=f.x;k=f.y;o=new Rect(i,h,g,k);if(o.isPointInBB(a,b,c)&&(i=Math.abs(i*k+g*b+a*h-g*h-a*k-i*b),e=e.distanceFrom(f),e=i/e,e<=c))return true;e=f}return false},controlPolygonLength:function(){for(var a=0,b=1;b<this.order;++b)a+=this.points[b-1].distanceFrom(this.points[b]);return(this.controlPolygonLength=
function(){return a})()},chordLength:function(){var a=this.points[0].distanceFrom(this.points[this.order-1]);return(this.chordLength=function(){return a})()},triangle:function(){for(var a=this.points,b=[a],c=1;c<this.order;++c){for(var d=[],e=0;e<this.order-c;++e){var f=a[e],i=a[e+1];d[e]=new Point((f.x+i.x)/2,(f.y+i.y)/2)}b.push(d);a=d}return(this.triangle=function(){return b})()},triangleAtT:function(a){for(var b=1-a,c=this.points,d=[c],e=1;e<this.order;++e){for(var f=[],i=0;i<this.order-e;++i){var h=
c[i],g=c[i+1];f[i]=new Point(h.x*b+g.x*a,h.y*b+g.y*a)}d.push(f);c=f}return d},split:function(a){"undefined"==typeof a&&(a=0.5);for(var a=0.5==a?this.triangle():this.triangleAtT(a),b=Array(this.order),c=Array(this.order),d=0;d<this.order;++d)b[d]=a[d][0],c[d]=a[this.order-1-d][d];return{left:new Bezier(b),right:new Bezier(c)}},mid:function(a,b){return this.split(b).left.split(a/b).right},chordPoints:function(){var a=[{tStart:0,tEnd:0,dt:0,p:this.points[0]}].concat(this._chordPoints(0,1));return(this.chordPoints=
function(){return a})()},_chordPoints:function(a,b){var c=b-a;if(this.controlPolygonLength()<=1.001*this.chordLength())return[{tStart:a,tEnd:b,dt:c,p:this.points[this.order-1]}];else{var c=a+c/2,d=this.split();return d.left._chordPoints(a,c).concat(d.right._chordPoints(c,b))}},markedEvery:function(a,b){for(var c=b||a,d=this.chordPoints(),e=[],f=0,i,h,g=1;g<d.length;++g)if(h=d[g],h.length=h.p.distanceFrom(d[g-1].p),0==h.length)f+=h.dt;else{i=c/h.length*h.dt;for(h.remainingLength=h.length;h.remainingLength>=
c;)h.remainingLength-=c,f+=i,e.push(f),a!=c&&(c=a,i=c/h.length*h.dt);c-=h.remainingLength;f=h.tEnd}return{times:e,nextDistance:c}},coefficients:function(){function a(a){for(;a.length>1;){for(var b=Array(a.length-1),c=0;c<a.length-1;++c){var d=b,e=c,f=a[c],j=a[c+1];f.push(0);var q=Array(f.length);q[0]=f[0];for(var m=0;m<j.length;++m)q[m+1]=f[m+1]+j[m]-f[m];d[e]=q}a=b}return a[0]}for(var b=[],c=[],d=0,e;e=this.points[d++];)b.push([e.x]),c.push([e.y]);var f={xs:a(b),ys:a(c)};return(this.coefficients=
function(){return f})()},pointAtT:function(a){for(var b=this.coefficients(),c=b.xs,b=b.ys,d=c[c.length-1],e=b[b.length-1],f=c.length-1;--f>=0;)d=d*a+c[f],e=e*a+b[f];return new Point(d,e)},makePath:function(a,b){"undefined"==typeof b&&(b=true);b&&a.moveTo(this.points[0].x,this.points[0].y);var c=this.pathCommands[this.order];if(c){for(var d=[],e=1==this.order?0:1;e<this.points.length;++e)d.push(this.points[e].x),d.push(this.points[e].y);c.apply(a,d)}},makeDashedPath:function(a,b,c,d){c||(c=b);"undefined"==
typeof d&&(d=true);b=this.markedEvery(b,c);d&&b.times.unshift(0);(d=b.times.length%2)&&b.times.push(1);for(c=1;c<b.times.length;c+=2)this.mid(b.times[c-1],b.times[c]).makePath(a);return{firstDistance:b.nextDistance,drawFirst:d}},makeDottedPath:function(a,b,c){c||(c=b);var d=this.markedEvery(b,c);b==c&&d.times.unshift(0);b=0;for(c=d.times.length;b<c;++b)this.pointAtT(d.times[b]).makePath(a);return d.nextDistance}});var Path=DotUtils.createClass({initialize:function(a){this.segments=a||[]},setupSegments:function(){},addBezier:function(a){this.segments.push(a instanceof Array?new Bezier(a):a)},offset:function(a,b){0==this.segments.length&&this.setupSegments();for(var c=0,d=this.segments.length;c<d;++c)this.segments[c].offset(a,b)},getBB:function(){var j;0==this.segments.length&&this.setupSegments();var a,b,c,d;b=this.segments[0].points[0];a=c=b.x;j=d=b.y,b=j;for(var e=0,f=this.segments.length;e<f;++e)for(var i=
this.segments[e].points,h=0,g=i.length;h<g;++h){var k=i[h];a=Math.min(a,k.x);b=Math.min(b,k.y);c=Math.max(c,k.x);d=Math.max(d,k.y)}var o=new Rect(a,b,c,d);return(this.getBB=function(){return o})()},isPointInBB:function(a,b,c){typeof c==="undefined"&&(c=0);var d=this.getBB();0<c&&(d=DotUtils.extend({},d),d.inset(-c,-c));return!(a<d.l||a>d.r||b<d.t||b>d.b)},isPointOnPath:function(a,b,c){typeof c==="undefined"&&(c=0);if(!this.isPointInBB(a,b,c))return false;for(var d=0,e=this.segments.length;d<e;++d)if(this.segments[d].isPointOnBezier(a,
b,c))throw $break;return false},isPointInPath:function(){return false},makePath:function(a){0==this.segments.length&&this.setupSegments();for(var b=true,c=0,d=this.segments.length;c<d;++c)this.segments[c].makePath(a,b),b=false},makeDashedPath:function(a,b,c,d){0==this.segments.length&&this.setupSegments();for(var c={drawFirst:"undefined"==typeof d?true:d,firstDistance:c||b},d=0,e=this.segments.length;d<e;++d)c=this.segments[d].makeDashedPath(a,b,c.firstDistance,c.drawFirst)},makeDottedPath:function(a,
b,c){0==this.segments.length&&this.setupSegments();c||(c=b);for(var d=0,e=this.segments.length;d<e;++d)c=this.segments[d].makeDottedPath(a,b,c)}});var Polygon=DotUtils.createClass(Path,{initialize:function($super,b){this.points=b||[];$super()},setupSegments:function(){for(var a=0,b=this.points.length;a<b;++a){var c=a+1;b==c&&(c=0);this.addBezier([this.points[a],this.points[c]])}}});var Rect=DotUtils.createClass(Polygon,{initialize:function($super,b,c,d,e){this.l=b;this.t=c;this.r=d;this.b=e;$super()},inset:function(a,b){this.l+=a;this.t+=b;this.r-=a;this.b-=b;return this},expandToInclude:function(a){this.l=Math.min(this.l,a.l);this.t=Math.min(this.t,a.t);this.r=Math.max(this.r,a.r);this.b=Math.max(this.b,a.b)},getWidth:function(){return this.r-this.l},getHeight:function(){return this.b-this.t},setupSegments:function($super){var b=this.getWidth(),c=this.getHeight();this.points=
[new Point(this.l,this.t),new Point(this.l+b,this.t),new Point(this.l+b,this.t+c),new Point(this.l,this.t+c)];$super()}});var Ellipse=DotUtils.createClass(Path,{KAPPA:0.5522847498,initialize:function($super,b,c,d,e){this.cx=b;this.cy=c;this.rx=d;this.ry=e;$super()},setupSegments:function(){this.addBezier([new Point(this.cx,this.cy-this.ry),new Point(this.cx+this.KAPPA*this.rx,this.cy-this.ry),new Point(this.cx+this.rx,this.cy-this.KAPPA*this.ry),new Point(this.cx+this.rx,this.cy)]);this.addBezier([new Point(this.cx+this.rx,this.cy),new Point(this.cx+this.rx,this.cy+this.KAPPA*this.ry),new Point(this.cx+this.KAPPA*this.rx,
this.cy+this.ry),new Point(this.cx,this.cy+this.ry)]);this.addBezier([new Point(this.cx,this.cy+this.ry),new Point(this.cx-this.KAPPA*this.rx,this.cy+this.ry),new Point(this.cx-this.rx,this.cy+this.KAPPA*this.ry),new Point(this.cx-this.rx,this.cy)]);this.addBezier([new Point(this.cx-this.rx,this.cy),new Point(this.cx-this.rx,this.cy-this.KAPPA*this.ry),new Point(this.cx-this.KAPPA*this.rx,this.cy-this.ry),new Point(this.cx,this.cy-this.ry)])}});